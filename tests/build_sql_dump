#!/bin/bash -x

# since Codeception is limited to one db dump to import,
# we need to collect all our SQL dump data into one file

CODECEPTION_DIR="tests/codeception"
DUMP_FILE="${CODECEPTION_DIR}/_data/sql/dump.sql";

cat << EOF

    Building SQL dump at:
    ${DUMP_FILE}
    ...

EOF

cat >${DUMP_FILE} << EOL
/* This file was automatically generated by the test runner */

EOL

# setup
cat ${CODECEPTION_DIR}/_data/sql/setup/*.sql >> ${DUMP_FILE}

# db structure
cat "install/sql/001-mellivora.sql" >> ${DUMP_FILE};

# countries
cat "install/sql/002-countries.sql" >> ${DUMP_FILE};

cat ${CODECEPTION_DIR}/_data/sql/acceptance/*.sql >> ${DUMP_FILE}

cat << EOF
    Finished building SQL dump.

EOF